# Microsoft.EntityFrameworkCore.InMemory.Query.Internal

``` diff
 namespace Microsoft.EntityFrameworkCore.InMemory.Query.Internal {
+    public class EntityProjectionExpression : Expression, IPrintableExpression {
+        public EntityProjectionExpression(IEntityType entityType, IDictionary<IProperty, Expression> readExpressionMap);
+        public virtual IEntityType EntityType { get; }
+        public sealed override ExpressionType NodeType { get; }
+        public override Type Type { get; }
+        public virtual void AddNavigationBinding(INavigation navigation, EntityShaperExpression entityShaper);
+        public virtual EntityShaperExpression BindNavigation(INavigation navigation);
+        public virtual Expression BindProperty(IProperty property);
+        public virtual void Print(ExpressionPrinter expressionPrinter);
+        public virtual EntityProjectionExpression UpdateEntityType(IEntityType derivedType);
+    }
-    public interface IInMemoryMaterializerFactory {
 {
-        Expression<Func<IEntityType, MaterializationContext, object>> CreateMaterializer(IEntityType entityType);

-    }
+    public class InMemoryExpressionTranslatingExpressionVisitor : ExpressionVisitor {
+        public InMemoryExpressionTranslatingExpressionVisitor(QueryableMethodTranslatingExpressionVisitor queryableMethodTranslatingExpressionVisitor);
+        public virtual Expression Translate(Expression expression);
+        protected override Expression VisitBinary(BinaryExpression binaryExpression);
+        protected override Expression VisitConditional(ConditionalExpression conditionalExpression);
+        protected override Expression VisitExtension(Expression extensionExpression);
+        protected override Expression VisitInvocation(InvocationExpression node);
+        protected override Expression VisitLambda<T>(Expression<T> node);
+        protected override Expression VisitListInit(ListInitExpression node);
+        protected override Expression VisitMember(MemberExpression memberExpression);
+        protected override MemberAssignment VisitMemberAssignment(MemberAssignment memberAssignment);
+        protected override Expression VisitMethodCall(MethodCallExpression methodCallExpression);
+        protected override Expression VisitNew(NewExpression newExpression);
+        protected override Expression VisitNewArray(NewArrayExpression newArrayExpression);
+        protected override Expression VisitParameter(ParameterExpression parameterExpression);
+        protected override Expression VisitTypeBinary(TypeBinaryExpression typeBinaryExpression);
+        protected override Expression VisitUnary(UnaryExpression unaryExpression);
+    }
+    public class InMemoryGroupByShaperExpression : GroupByShaperExpression {
+        public InMemoryGroupByShaperExpression(Expression keySelector, Expression elementSelector, ParameterExpression groupingParameter, ParameterExpression valueBufferParameter);
+        public virtual ParameterExpression GroupingParameter { get; }
+        public virtual ParameterExpression ValueBufferParameter { get; }
+    }
+    public static class InMemoryLinqOperatorProvider {
+        public static MethodInfo All { get; }
+        public static MethodInfo AnyWithoutPredicate { get; }
+        public static MethodInfo AnyWithPredicate { get; }
+        public static MethodInfo AsEnumerable { get; }
+        public static MethodInfo Cast { get; }
+        public static MethodInfo Concat { get; }
+        public static MethodInfo Contains { get; }
+        public static MethodInfo CountWithoutPredicate { get; }
+        public static MethodInfo CountWithPredicate { get; }
+        public static MethodInfo DefaultIfEmptyWithArgument { get; }
+        public static MethodInfo DefaultIfEmptyWithoutArgument { get; }
+        public static MethodInfo Distinct { get; }
+        public static MethodInfo ElementAt { get; }
+        public static MethodInfo ElementAtOrDefault { get; }
+        public static MethodInfo Except { get; }
+        public static MethodInfo FirstOrDefaultWithoutPredicate { get; }
+        public static MethodInfo FirstOrDefaultWithPredicate { get; }
+        public static MethodInfo FirstWithoutPredicate { get; }
+        public static MethodInfo FirstWithPredicate { get; }
+        public static MethodInfo GroupByWithKeyElementResultSelector { get; }
+        public static MethodInfo GroupByWithKeyElementSelector { get; }
+        public static MethodInfo GroupByWithKeyResultSelector { get; }
+        public static MethodInfo GroupByWithKeySelector { get; }
+        public static MethodInfo GroupJoin { get; }
+        public static MethodInfo Intersect { get; }
+        public static MethodInfo Join { get; }
+        public static MethodInfo LastOrDefaultWithoutPredicate { get; }
+        public static MethodInfo LastOrDefaultWithPredicate { get; }
+        public static MethodInfo LastWithoutPredicate { get; }
+        public static MethodInfo LastWithPredicate { get; }
+        public static MethodInfo LongCountWithoutPredicate { get; }
+        public static MethodInfo LongCountWithPredicate { get; }
+        public static MethodInfo MaxWithoutSelector { get; }
+        public static MethodInfo MaxWithSelector { get; }
+        public static MethodInfo MinWithoutSelector { get; }
+        public static MethodInfo MinWithSelector { get; }
+        public static MethodInfo OfType { get; }
+        public static MethodInfo OrderBy { get; }
+        public static MethodInfo OrderByDescending { get; }
+        public static MethodInfo Reverse { get; }
+        public static MethodInfo Select { get; }
+        public static MethodInfo SelectManyWithCollectionSelector { get; }
+        public static MethodInfo SelectManyWithoutCollectionSelector { get; }
+        public static MethodInfo SingleOrDefaultWithoutPredicate { get; }
+        public static MethodInfo SingleOrDefaultWithPredicate { get; }
+        public static MethodInfo SingleWithoutPredicate { get; }
+        public static MethodInfo SingleWithPredicate { get; }
+        public static MethodInfo Skip { get; }
+        public static MethodInfo SkipWhile { get; }
+        public static MethodInfo Take { get; }
+        public static MethodInfo TakeWhile { get; }
+        public static MethodInfo ThenBy { get; }
+        public static MethodInfo ThenByDescending { get; }
+        public static MethodInfo Union { get; }
+        public static MethodInfo Where { get; }
+        public static MethodInfo GetAverageWithoutSelector(Type type);
+        public static MethodInfo GetAverageWithSelector(Type type);
+        public static MethodInfo GetMaxWithoutSelector(Type type);
+        public static MethodInfo GetMaxWithSelector(Type type);
+        public static MethodInfo GetMinWithoutSelector(Type type);
+        public static MethodInfo GetMinWithSelector(Type type);
+        public static MethodInfo GetSumWithoutSelector(Type type);
+        public static MethodInfo GetSumWithSelector(Type type);
+    }
-    public class InMemoryMaterializerFactory : IInMemoryMaterializerFactory {
 {
-        public InMemoryMaterializerFactory(IEntityMaterializerSource entityMaterializerSource);

-        public virtual Expression<Func<IEntityType, MaterializationContext, object>> CreateMaterializer(IEntityType entityType);

-    }
+    public class InMemoryProjectionBindingExpressionVisitor : ExpressionVisitor {
+        public InMemoryProjectionBindingExpressionVisitor(InMemoryQueryableMethodTranslatingExpressionVisitor queryableMethodTranslatingExpressionVisitor, InMemoryExpressionTranslatingExpressionVisitor expressionTranslatingExpressionVisitor);
+        public virtual Expression Translate(InMemoryQueryExpression queryExpression, Expression expression);
+        public override Expression Visit(Expression expression);
+        protected override Expression VisitExtension(Expression extensionExpression);
+        protected override MemberAssignment VisitMemberAssignment(MemberAssignment memberAssignment);
+        protected override Expression VisitMemberInit(MemberInitExpression memberInitExpression);
+        protected override Expression VisitNew(NewExpression newExpression);
+    }
+    public class InMemoryQueryableMethodTranslatingExpressionVisitor : QueryableMethodTranslatingExpressionVisitor {
+        protected InMemoryQueryableMethodTranslatingExpressionVisitor(InMemoryQueryableMethodTranslatingExpressionVisitor parentVisitor);
+        public InMemoryQueryableMethodTranslatingExpressionVisitor(QueryableMethodTranslatingExpressionVisitorDependencies dependencies, IModel model);
+        protected override ShapedQueryExpression CreateShapedQueryExpression(Type elementType);
+        protected override QueryableMethodTranslatingExpressionVisitor CreateSubqueryVisitor();
+        protected override ShapedQueryExpression TranslateAll(ShapedQueryExpression source, LambdaExpression predicate);
+        protected override ShapedQueryExpression TranslateAny(ShapedQueryExpression source, LambdaExpression predicate);
+        protected override ShapedQueryExpression TranslateAverage(ShapedQueryExpression source, LambdaExpression selector, Type resultType);
+        protected override ShapedQueryExpression TranslateCast(ShapedQueryExpression source, Type resultType);
+        protected override ShapedQueryExpression TranslateConcat(ShapedQueryExpression source1, ShapedQueryExpression source2);
+        protected override ShapedQueryExpression TranslateContains(ShapedQueryExpression source, Expression item);
+        protected override ShapedQueryExpression TranslateCount(ShapedQueryExpression source, LambdaExpression predicate);
+        protected override ShapedQueryExpression TranslateDefaultIfEmpty(ShapedQueryExpression source, Expression defaultValue);
+        protected override ShapedQueryExpression TranslateDistinct(ShapedQueryExpression source);
+        protected override ShapedQueryExpression TranslateElementAtOrDefault(ShapedQueryExpression source, Expression index, bool returnDefault);
+        protected override ShapedQueryExpression TranslateExcept(ShapedQueryExpression source1, ShapedQueryExpression source2);
+        protected override ShapedQueryExpression TranslateFirstOrDefault(ShapedQueryExpression source, LambdaExpression predicate, Type returnType, bool returnDefault);
+        protected override ShapedQueryExpression TranslateGroupBy(ShapedQueryExpression source, LambdaExpression keySelector, LambdaExpression elementSelector, LambdaExpression resultSelector);
+        protected override ShapedQueryExpression TranslateGroupJoin(ShapedQueryExpression outer, ShapedQueryExpression inner, LambdaExpression outerKeySelector, LambdaExpression innerKeySelector, LambdaExpression resultSelector);
+        protected override ShapedQueryExpression TranslateIntersect(ShapedQueryExpression source1, ShapedQueryExpression source2);
+        protected override ShapedQueryExpression TranslateJoin(ShapedQueryExpression outer, ShapedQueryExpression inner, LambdaExpression outerKeySelector, LambdaExpression innerKeySelector, LambdaExpression resultSelector);
+        protected override ShapedQueryExpression TranslateLastOrDefault(ShapedQueryExpression source, LambdaExpression predicate, Type returnType, bool returnDefault);
+        protected override ShapedQueryExpression TranslateLeftJoin(ShapedQueryExpression outer, ShapedQueryExpression inner, LambdaExpression outerKeySelector, LambdaExpression innerKeySelector, LambdaExpression resultSelector);
+        protected override ShapedQueryExpression TranslateLongCount(ShapedQueryExpression source, LambdaExpression predicate);
+        protected override ShapedQueryExpression TranslateMax(ShapedQueryExpression source, LambdaExpression selector, Type resultType);
+        protected override ShapedQueryExpression TranslateMin(ShapedQueryExpression source, LambdaExpression selector, Type resultType);
+        protected override ShapedQueryExpression TranslateOfType(ShapedQueryExpression source, Type resultType);
+        protected override ShapedQueryExpression TranslateOrderBy(ShapedQueryExpression source, LambdaExpression keySelector, bool ascending);
+        protected override ShapedQueryExpression TranslateReverse(ShapedQueryExpression source);
+        protected override ShapedQueryExpression TranslateSelect(ShapedQueryExpression source, LambdaExpression selector);
+        protected override ShapedQueryExpression TranslateSelectMany(ShapedQueryExpression source, LambdaExpression selector);
+        protected override ShapedQueryExpression TranslateSelectMany(ShapedQueryExpression source, LambdaExpression collectionSelector, LambdaExpression resultSelector);
+        protected override ShapedQueryExpression TranslateSingleOrDefault(ShapedQueryExpression source, LambdaExpression predicate, Type returnType, bool returnDefault);
+        protected override ShapedQueryExpression TranslateSkip(ShapedQueryExpression source, Expression count);
+        protected override ShapedQueryExpression TranslateSkipWhile(ShapedQueryExpression source, LambdaExpression predicate);
+        protected override ShapedQueryExpression TranslateSum(ShapedQueryExpression source, LambdaExpression selector, Type resultType);
+        protected override ShapedQueryExpression TranslateTake(ShapedQueryExpression source, Expression count);
+        protected override ShapedQueryExpression TranslateTakeWhile(ShapedQueryExpression source, LambdaExpression predicate);
+        protected override ShapedQueryExpression TranslateThenBy(ShapedQueryExpression source, LambdaExpression keySelector, bool ascending);
+        protected override ShapedQueryExpression TranslateUnion(ShapedQueryExpression source1, ShapedQueryExpression source2);
+        protected override ShapedQueryExpression TranslateWhere(ShapedQueryExpression source, LambdaExpression predicate);
+    }
+    public class InMemoryQueryableMethodTranslatingExpressionVisitorFactory : IQueryableMethodTranslatingExpressionVisitorFactory {
+        public InMemoryQueryableMethodTranslatingExpressionVisitorFactory(QueryableMethodTranslatingExpressionVisitorDependencies dependencies);
+        public virtual QueryableMethodTranslatingExpressionVisitor Create(IModel model);
+    }
     public class InMemoryQueryContext : QueryContext {
+        public InMemoryQueryContext(QueryContextDependencies dependencies, IInMemoryStore store);
-        public InMemoryQueryContext(QueryContextDependencies dependencies, Func<IQueryBuffer> queryBufferFactory, IInMemoryStore store);

     }
-    public class InMemoryQueryContextFactory : QueryContextFactory {
+    public class InMemoryQueryContextFactory : IQueryContextFactory {
-        public override QueryContext Create();
+        public virtual QueryContext Create();
     }
+    public class InMemoryQueryExpression : Expression, IPrintableExpression {
+        public InMemoryQueryExpression(IEntityType entityType);
+        public virtual ParameterExpression CurrentParameter { get; }
+        public sealed override ExpressionType NodeType { get; }
+        public virtual IReadOnlyList<Expression> Projection { get; }
+        public virtual Expression ServerQueryExpression { get; set; }
+        public override Type Type { get; }
+        public virtual void AddInnerJoin(InMemoryQueryExpression innerQueryExpression, LambdaExpression outerKeySelector, LambdaExpression innerKeySelector, Type transparentIdentifierType);
+        public virtual void AddLeftJoin(InMemoryQueryExpression innerQueryExpression, LambdaExpression outerKeySelector, LambdaExpression innerKeySelector, Type transparentIdentifierType);
+        public virtual EntityShaperExpression AddNavigationToWeakEntityType(EntityProjectionExpression entityProjectionExpression, INavigation navigation, InMemoryQueryExpression innerQueryExpression, LambdaExpression outerKeySelector, LambdaExpression innerKeySelector);
+        public virtual void AddSelectMany(InMemoryQueryExpression innerQueryExpression, Type transparentIdentifierType, bool innerNullable);
+        public virtual int AddSubqueryProjection(ShapedQueryExpression shapedQueryExpression, out Expression innerShaper);
+        public virtual IDictionary<IProperty, int> AddToProjection(EntityProjectionExpression entityProjectionExpression);
+        public virtual int AddToProjection(Expression expression);
+        public virtual void ApplyDefaultIfEmpty();
+        public virtual InMemoryGroupByShaperExpression ApplyGrouping(Expression groupingKey, Expression shaperExpression);
+        public virtual void ApplyProjection();
+        public virtual void ConvertToEnumerable();
+        public virtual Expression GetMappedProjection(ProjectionMember member);
+        public virtual Expression GetSingleScalarProjection();
+        public virtual void Print(ExpressionPrinter expressionPrinter);
+        public virtual void PushdownIntoSubquery();
+        public virtual void ReplaceProjectionMapping(IDictionary<ProjectionMember, Expression> projectionMappings);
+    }
-    public class InMemoryQueryModelVisitor : EntityQueryModelVisitor {
 {
-        public static readonly MethodInfo EntityQueryMethodInfo;

-        public static readonly MethodInfo ProjectionQueryMethodInfo;

-        public InMemoryQueryModelVisitor(EntityQueryModelVisitorDependencies dependencies, QueryCompilationContext queryCompilationContext);

-    }
-    public class InMemoryQueryModelVisitorFactory : EntityQueryModelVisitorFactory {
 {
-        public InMemoryQueryModelVisitorFactory(EntityQueryModelVisitorDependencies dependencies);

-        public override EntityQueryModelVisitor Create(QueryCompilationContext queryCompilationContext, EntityQueryModelVisitor parentEntityQueryModelVisitor);

-    }
+    public class InMemoryQueryTranslationPostprocessor : QueryTranslationPostprocessor {
+        public InMemoryQueryTranslationPostprocessor(QueryTranslationPostprocessorDependencies dependencies);
+        public override Expression Process(Expression query);
+    }
+    public class InMemoryQueryTranslationPostprocessorFactory : IQueryTranslationPostprocessorFactory {
+        public InMemoryQueryTranslationPostprocessorFactory(QueryTranslationPostprocessorDependencies dependencies);
+        public virtual QueryTranslationPostprocessor Create(QueryCompilationContext queryCompilationContext);
+    }
+    public class InMemoryShapedQueryCompilingExpressionVisitor : ShapedQueryCompilingExpressionVisitor {
+        public InMemoryShapedQueryCompilingExpressionVisitor(ShapedQueryCompilingExpressionVisitorDependencies dependencies, QueryCompilationContext queryCompilationContext);
+        protected override Expression VisitExtension(Expression extensionExpression);
+        protected override Expression VisitShapedQueryExpression(ShapedQueryExpression shapedQueryExpression);
+    }
+    public class InMemoryShapedQueryCompilingExpressionVisitorFactory : IShapedQueryCompilingExpressionVisitorFactory {
+        public InMemoryShapedQueryCompilingExpressionVisitorFactory(ShapedQueryCompilingExpressionVisitorDependencies dependencies);
+        public virtual ShapedQueryCompilingExpressionVisitor Create(QueryCompilationContext queryCompilationContext);
+    }
+    public class InMemoryTableExpression : Expression, IPrintableExpression {
+        public InMemoryTableExpression(IEntityType entityType);
+        public virtual IEntityType EntityType { get; }
+        public sealed override ExpressionType NodeType { get; }
+        public override Type Type { get; }
+        public virtual void Print(ExpressionPrinter expressionPrinter);
+        protected override Expression VisitChildren(ExpressionVisitor visitor);
+    }
+    public class ShaperExpressionProcessingExpressionVisitor : ExpressionVisitor {
+        public ShaperExpressionProcessingExpressionVisitor(InMemoryQueryExpression queryExpression, ParameterExpression valueBufferParameter);
+        public virtual Expression Inject(Expression expression);
+        protected override Expression VisitExtension(Expression extensionExpression);
+    }
+    public class SingleResultShaperExpression : Expression, IPrintableExpression {
+        public SingleResultShaperExpression(Expression projection, Expression innerShaper, Type type);
+        public virtual Expression InnerShaper { get; }
+        public sealed override ExpressionType NodeType { get; }
+        public virtual Expression Projection { get; }
+        public override Type Type { get; }
+        public virtual void Print(ExpressionPrinter expressionPrinter);
+        public virtual SingleResultShaperExpression Update(Expression projection, Expression innerShaper);
+        protected override Expression VisitChildren(ExpressionVisitor visitor);
+    }
 }
```

