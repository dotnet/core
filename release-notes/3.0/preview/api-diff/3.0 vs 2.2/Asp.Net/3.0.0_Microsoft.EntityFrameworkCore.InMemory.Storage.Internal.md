# Microsoft.EntityFrameworkCore.InMemory.Storage.Internal

``` diff
 namespace Microsoft.EntityFrameworkCore.InMemory.Storage.Internal {
     public interface IInMemoryDatabase : IDatabase {
+        bool EnsureDatabaseCreated();
-        bool EnsureDatabaseCreated(StateManagerDependencies stateManagerDependencies);

     }
     public interface IInMemoryStore {
-        bool EnsureCreated(StateManagerDependencies stateManagerDependencies, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);

+        bool EnsureCreated(IUpdateAdapterFactory updateAdapterFactory, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);
+        int ExecuteTransaction(IList<IUpdateEntry> entries, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);
-        int ExecuteTransaction(IReadOnlyList<IUpdateEntry> entries, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);

+        InMemoryIntegerValueGenerator<TProperty> GetIntegerValueGenerator<TProperty>(IProperty property);
     }
     public interface IInMemoryTable {
+        InMemoryIntegerValueGenerator<TProperty> GetIntegerValueGenerator<TProperty>(IProperty property);
     }
     public class InMemoryDatabase : Database, IDatabase, IInMemoryDatabase {
-        public InMemoryDatabase(DatabaseDependencies dependencies, IInMemoryStoreCache storeCache, IDbContextOptions options, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);

+        public InMemoryDatabase(DatabaseDependencies dependencies, IInMemoryStoreCache storeCache, IDbContextOptions options, IUpdateAdapterFactory updateAdapterFactory, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);
-        public override Func<QueryContext, IAsyncEnumerable<TResult>> CompileAsyncQuery<TResult>(QueryModel queryModel);

+        public virtual bool EnsureDatabaseCreated();
-        public virtual bool EnsureDatabaseCreated(StateManagerDependencies stateManagerDependencies);

+        public override int SaveChanges(IList<IUpdateEntry> entries);
-        public override int SaveChanges(IReadOnlyList<IUpdateEntry> entries);

+        public override Task<int> SaveChangesAsync(IList<IUpdateEntry> entries, CancellationToken cancellationToken = default(CancellationToken));
-        public override Task<int> SaveChangesAsync(IReadOnlyList<IUpdateEntry> entries, CancellationToken cancellationToken = default(CancellationToken));

     }
-    public class InMemoryDatabaseCreator : IDatabaseCreator, IDatabaseCreatorWithCanConnect {
+    public class InMemoryDatabaseCreator : IDatabaseCreator {
-        public InMemoryDatabaseCreator(StateManagerDependencies stateManagerDependencies);

+        public InMemoryDatabaseCreator(IDatabase database);
     }
     public class InMemoryStore : IInMemoryStore {
-        public virtual bool EnsureCreated(StateManagerDependencies stateManagerDependencies, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);

+        public virtual bool EnsureCreated(IUpdateAdapterFactory updateAdapterFactory, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);
+        public virtual int ExecuteTransaction(IList<IUpdateEntry> entries, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);
-        public virtual int ExecuteTransaction(IReadOnlyList<IUpdateEntry> entries, IDiagnosticsLogger<DbLoggerCategory.Update> updateLogger);

+        public virtual InMemoryIntegerValueGenerator<TProperty> GetIntegerValueGenerator<TProperty>(IProperty property);
     }
     public class InMemoryStoreCache : IInMemoryStoreCache {
-        public InMemoryStoreCache(IInMemoryTableFactory tableFactory);

     }
     public class InMemoryTable<TKey> : IInMemoryTable {
+        public virtual InMemoryIntegerValueGenerator<TProperty> GetIntegerValueGenerator<TProperty>(IProperty property);
     }
-    public class InMemoryTransaction : IDbContextTransaction, IDisposable {
+    public class InMemoryTransaction : IAsyncDisposable, IDbContextTransaction, IDisposable {
+        public virtual Task CommitAsync(CancellationToken cancellationToken = default(CancellationToken));
+        public virtual ValueTask DisposeAsync();
+        public virtual Task RollbackAsync(CancellationToken cancellationToken = default(CancellationToken));
     }
     public class InMemoryTransactionManager : IDbContextTransactionManager, IResettableService, ITransactionEnlistmentManager {
+        public virtual Task ResetStateAsync(CancellationToken cancellationToken = default(CancellationToken));
     }
 }
```

