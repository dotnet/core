# Microsoft.EntityFrameworkCore.TestUtilities

``` diff
 namespace Microsoft.EntityFrameworkCore.TestUtilities {
-    public class GeometryComparer : IEqualityComparer<IGeometry> {
+    public class GeometryComparer : IEqualityComparer<Geometry> {
-        public bool Equals(IGeometry x, IGeometry y);

+        public bool Equals(Geometry x, Geometry y);
-        public int GetHashCode(IGeometry obj);

+        public int GetHashCode(Geometry obj);
     }
+    public static class QueryableExtensions {
+        public static Task<List<TSource>> ToListAsync<TSource>(this IQueryable source, CancellationToken cancellationToken = default(CancellationToken));
+    }
     public class QueryAsserter<TContext> : QueryAsserterBase where TContext : DbContext {
+        public override Task AssertAverage<TItem1>(Func<IQueryable<TItem1>, IQueryable<int?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<int?>> expectedQuery, Action<object, object> asserter = null, bool isAsync = false);
-        public Task<List<object>> AssertIncludeQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> query, List<IExpectedInclude> expectedIncludes, dynamic elementSorter = null, dynamic clientProjections = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public Task<List<object>> AssertIncludeQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> query, List<IExpectedInclude> expectedIncludes, dynamic elementSorter, dynamic clientProjections, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public override Task<List<object>> AssertIncludeQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter = null, dynamic clientProjections = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false);

+        public override Task<List<object>> AssertIncludeQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter, dynamic clientProjections, bool assertOrder, int entryCount, bool isAsync, string testMethodName);
-        public Task<List<object>> AssertIncludeQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> query, List<IExpectedInclude> expectedIncludes, dynamic elementSorter = null, dynamic clientProjections = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class;

+        public Task<List<object>> AssertIncludeQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> query, List<IExpectedInclude> expectedIncludes, dynamic elementSorter, dynamic clientProjections, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class;
-        public override Task<List<object>> AssertIncludeQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter = null, dynamic clientProjections = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false);

+        public override Task<List<object>> AssertIncludeQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter, dynamic clientProjections, bool assertOrder, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertQuery<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> expectedQuery, dynamic elementSorter = null, dynamic elementAsserter = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false);

+        public override Task AssertQuery<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> expectedQuery, dynamic elementSorter, dynamic elementAsserter, bool assertOrder, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, dynamic elementSorter = null, dynamic elementAsserter = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false);

+        public override Task AssertQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, dynamic elementSorter, dynamic elementAsserter, bool assertOrder, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, dynamic elementSorter = null, dynamic elementAsserter = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false);

+        public override Task AssertQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, dynamic elementSorter, dynamic elementAsserter, bool assertOrder, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertQueryScalar<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> expectedQuery, bool assertOrder = false, bool isAsync = false);

+        public override Task AssertQueryScalar<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName);
-        public virtual Task AssertQueryScalar<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<int>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class where TItem3 : class;

+        public virtual Task AssertQueryScalar<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<int>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class where TItem3 : class;
-        public override Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> expectedQuery, bool assertOrder = false, bool isAsync = false);

+        public override Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName);
-        public override Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> expectedQuery, bool assertOrder = false, bool isAsync = false);

+        public override Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName);
-        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int?>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int?>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int?>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public virtual Task AssertQueryScalar<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<int?>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public override Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult?>> expectedQuery, bool assertOrder = false, bool isAsync = false);

+        public override Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult?>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName);
-        public override Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult>> expectedQuery, bool assertOrder = false, bool isAsync = false);

+        public override Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName);
-        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<short>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<short>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int>> actualQuery, Func<IQueryable<TItem1>, IQueryable<int>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int>> actualQuery, Func<IQueryable<TItem1>, IQueryable<int>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<long>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<long>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int?>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int?>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<int?>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalar<TItem1>(Func<IQueryable<TItem1>, IQueryable<int?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<int?>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public virtual Task AssertQueryScalarAsync<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TResult : struct;

+        public virtual Task AssertQueryScalarAsync<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TResult : struct;
-        public virtual Task AssertQueryScalarAsync<TItem1>(Func<IQueryable<TItem1>, IQueryable<bool>> query, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public virtual Task AssertQueryScalarAsync<TItem1>(Func<IQueryable<TItem1>, IQueryable<bool>> query, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public override Task AssertSingleResult<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false);

+        public override Task AssertSingleResult<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertSingleResult<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false);

+        public override Task AssertSingleResult<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertSingleResult<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false);

+        public override Task AssertSingleResult<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertSingleResult<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, object> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false);

+        public override Task AssertSingleResult<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, object> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertSingleResult<TItem1, TResult>(Func<IQueryable<TItem1>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, TResult> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false);

+        public override Task AssertSingleResult<TItem1, TResult>(Func<IQueryable<TItem1>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, TResult> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName);
-        public override Task AssertSingleResult<TItem1>(Func<IQueryable<TItem1>, object> actualSyncQuery, Func<IQueryable<TItem1>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, object> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false);

+        public override Task AssertSingleResult<TItem1>(Func<IQueryable<TItem1>, object> actualSyncQuery, Func<IQueryable<TItem1>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, object> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName);
     }
     public abstract class QueryAsserterBase {
+        public abstract Task AssertAverage<TItem1>(Func<IQueryable<TItem1>, IQueryable<int?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<int?>> expectedQuery, Action<object, object> asserter = null, bool isAsync = false) where TItem1 : class;
-        public abstract Task<List<object>> AssertIncludeQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter = null, dynamic clientProjections = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public abstract Task<List<object>> AssertIncludeQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter, dynamic clientProjections, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public abstract Task<List<object>> AssertIncludeQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter = null, dynamic clientProjections = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class;

+        public abstract Task<List<object>> AssertIncludeQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, List<IExpectedInclude> expectedIncludes, dynamic elementSorter, dynamic clientProjections, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class;
-        public abstract Task AssertQuery<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> expectedQuery, dynamic elementSorter = null, dynamic elementAsserter = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class where TItem3 : class;

+        public abstract Task AssertQuery<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<object>> expectedQuery, dynamic elementSorter, dynamic elementAsserter, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class where TItem3 : class;
-        public abstract Task AssertQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, dynamic elementSorter = null, dynamic elementAsserter = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public abstract Task AssertQuery<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<object>> expectedQuery, dynamic elementSorter, dynamic elementAsserter, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public abstract Task AssertQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, dynamic elementSorter = null, dynamic elementAsserter = null, bool assertOrder = false, int entryCount = 0, bool isAsync = false) where TItem1 : class;

+        public abstract Task AssertQuery<TItem1>(Func<IQueryable<TItem1>, IQueryable<object>> actualQuery, Func<IQueryable<TItem1>, IQueryable<object>> expectedQuery, dynamic elementSorter, dynamic elementAsserter, bool assertOrder, int entryCount, bool isAsync, string testMethodName) where TItem1 : class;
-        public abstract Task AssertQueryScalar<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class where TItem3 : class;

+        public abstract Task AssertQueryScalar<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, IQueryable<TResult>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class where TItem3 : class;
-        public abstract Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class where TResult : struct;

+        public abstract Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult?>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class where TResult : struct;
-        public abstract Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public abstract Task AssertQueryScalar<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TResult>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public abstract Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult?>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class where TResult : struct;

+        public abstract Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult?>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult?>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class where TResult : struct;
-        public abstract Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult>> expectedQuery, bool assertOrder = false, bool isAsync = false) where TItem1 : class;

+        public abstract Task AssertQueryScalar<TItem1, TResult>(Func<IQueryable<TItem1>, IQueryable<TResult>> actualQuery, Func<IQueryable<TItem1>, IQueryable<TResult>> expectedQuery, bool assertOrder, bool isAsync, string testMethodName) where TItem1 : class;
-        public abstract Task AssertSingleResult<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class where TItem3 : class;

+        public abstract Task AssertSingleResult<TItem1, TItem2, TItem3, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, TResult> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class where TItem3 : class;
-        public abstract Task AssertSingleResult<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class where TItem3 : class;

+        public abstract Task AssertSingleResult<TItem1, TItem2, TItem3>(Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, IQueryable<TItem3>, object> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class where TItem3 : class;
-        public abstract Task AssertSingleResult<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public abstract Task AssertSingleResult<TItem1, TItem2, TResult>(Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, TResult> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public abstract Task AssertSingleResult<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, object> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false) where TItem1 : class where TItem2 : class;

+        public abstract Task AssertSingleResult<TItem1, TItem2>(Func<IQueryable<TItem1>, IQueryable<TItem2>, object> actualSyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, IQueryable<TItem2>, object> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName) where TItem1 : class where TItem2 : class;
-        public abstract Task AssertSingleResult<TItem1, TResult>(Func<IQueryable<TItem1>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, TResult> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false) where TItem1 : class;

+        public abstract Task AssertSingleResult<TItem1, TResult>(Func<IQueryable<TItem1>, TResult> actualSyncQuery, Func<IQueryable<TItem1>, Task<TResult>> actualAsyncQuery, Func<IQueryable<TItem1>, TResult> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName) where TItem1 : class;
-        public abstract Task AssertSingleResult<TItem1>(Func<IQueryable<TItem1>, object> actualSyncQuery, Func<IQueryable<TItem1>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, object> expectedQuery, Action<object, object> asserter = null, int entryCount = 0, bool isAsync = false) where TItem1 : class;

+        public abstract Task AssertSingleResult<TItem1>(Func<IQueryable<TItem1>, object> actualSyncQuery, Func<IQueryable<TItem1>, Task<object>> actualAsyncQuery, Func<IQueryable<TItem1>, object> expectedQuery, Action<object, object> asserter, int entryCount, bool isAsync, string testMethodName) where TItem1 : class;
     }
     public abstract class RelationalDatabaseCleaner {
-        protected virtual DropForeignKeyOperation Drop(DatabaseForeignKey foreignKey);

+        protected virtual MigrationOperation Drop(DatabaseForeignKey foreignKey);
-        protected virtual DropIndexOperation Drop(DatabaseIndex index);

+        protected virtual MigrationOperation Drop(DatabaseIndex index);
-        protected virtual DropSequenceOperation Drop(DatabaseSequence sequence);

+        protected virtual MigrationOperation Drop(DatabaseSequence sequence);
-        protected virtual DropTableOperation Drop(DatabaseTable table);

+        protected virtual MigrationOperation Drop(DatabaseTable table);
     }
     public abstract class RelationalTestStore : TestStore {
-        public override TestStore Initialize(IServiceProvider serviceProvider, Func<DbContext> createContext, Action<DbContext> seed);

+        public override TestStore Initialize(IServiceProvider serviceProvider, Func<DbContext> createContext, Action<DbContext> seed = null, Action<DbContext> clean = null);
-        public virtual RawSqlString NormalizeDelimeters(RawSqlString sql);

-        public virtual FormattableString NormalizeDelimeters(FormattableString sql);

+        public virtual FormattableString NormalizeDelimetersInInterpolatedString(FormattableString sql);
+        public virtual string NormalizeDelimetersInRawString(string sql);
     }
     public abstract class TestHelpers {
+        public virtual LoggingDefinitions LoggingDefinitions { get; }
-        public ModelBuilder CreateConventionBuilder();

+        public ModelBuilder CreateConventionBuilder(DiagnosticsLogger<DbLoggerCategory.Model> modelLogger, DiagnosticsLogger<DbLoggerCategory.Model.Validation> validationLogger);
+        public ModelBuilder CreateConventionBuilder(bool skipValidation = false);
     }
-    public class TestLogger<TCategory> : TestLoggerBase, IDiagnosticsLogger<TCategory>, ILogger where TCategory : LoggerCategory<TCategory>, new() {
 {
-        public TestLogger();

-        public ILogger Logger { get; }

-        public ILoggingOptions Options { get; }

-        public IDisposable BeginScope<TState>(TState state);

-        public WarningBehavior GetLogBehavior(EventId eventId, LogLevel logLevel);

-        public bool IsEnabled(LogLevel logLevel);

-        public void Log<TState>(LogLevel logLevel, EventId eventId, TState state, Exception exception, Func<TState, Exception, string> formatter);

-        public bool ShouldLogSensitiveData();

-    }
+    public class TestLogger<TDefinitions> : TestLoggerBase, IDiagnosticsLogger, ILogger where TDefinitions : LoggingDefinitions, new() {
+        public TestLogger();
+        public virtual LoggingDefinitions Definitions { get; }
+        public ILogger Logger { get; }
+        public ILoggingOptions Options { get; }
+        public IDisposable BeginScope<TState>(TState state);
+        public bool IsEnabled(LogLevel logLevel);
+        public void Log<TState>(LogLevel logLevel, EventId eventId, TState state, Exception exception, Func<TState, Exception, string> formatter);
+        public bool ShouldLogSensitiveData();
+    }
+    public class TestLogger<TCategory, TDefinitions> : TestLogger<TDefinitions>, IDiagnosticsLogger, IDiagnosticsLogger<TCategory> where TCategory : LoggerCategory<TCategory>, new() where TDefinitions : LoggingDefinitions, new() {
+        public TestLogger();
+        public IInterceptors Interceptors { get; }
+    }
+    public class TestLoggingDefinitions : LoggingDefinitions {
+        public TestLoggingDefinitions();
+    }
     public class TestModelSource : ModelSource {
+        protected override IModel CreateModel(DbContext context, IConventionSetBuilder conventionSetBuilder);
-        protected override IModel CreateModel(DbContext context, IConventionSetBuilder conventionSetBuilder, IModelValidator validator);

     }
+    public class TestRelationalLoggingDefinitions : RelationalLoggingDefinitions {
+        public TestRelationalLoggingDefinitions();
+    }
     public class TestSqlLoggerFactory : ListLoggerFactory {
+        public void AssertBaseline(string[] expected);
-        public void AssertBaseline(string[] expected, bool assertOrder = true);

     }
     public abstract class TestStore : IDisposable {
+        public virtual Task CleanAsync(DbContext context);
+        public virtual Task DisposeAsync();
-        protected virtual void Initialize(Func<DbContext> createContext, Action<DbContext> seed);

+        protected virtual void Initialize(Func<DbContext> createContext, Action<DbContext> seed, Action<DbContext> clean);
-        public virtual TestStore Initialize(IServiceProvider serviceProvider, Func<DbContext> createContext, Action<DbContext> seed);

+        public virtual TestStore Initialize(IServiceProvider serviceProvider, Func<DbContext> createContext, Action<DbContext> seed = null, Action<DbContext> clean = null);
-        public TestStore Initialize(IServiceProvider serviceProvider, Func<TestStore, DbContext> createContext, Action<DbContext> seed);

+        public TestStore Initialize(IServiceProvider serviceProvider, Func<TestStore, DbContext> createContext, Action<DbContext> seed = null, Action<DbContext> clean = null);
     }
 }
```

