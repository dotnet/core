{
  "kind": "workflows",
  "title": "CVE Query Workflows",
  "schema_version": "1.0",
  "skill": "cve-queries",
  "ai_note": "Navigation paths for CVE queries. Read required_pre_read for stop criteria, interpretation, and common mistakes.",
  "required_pre_read": "https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/SKILL.md",
  "_links": {
    "self": {
      "href": "https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json"
    },
    "skill": {
      "href": "https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/SKILL.md"
    },
    "root-workflows": {
      "href": "https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/workflows.json"
    }
  },
  "_embedded": {
    "workflows": {
      "cve-latest": {
        "description": "All CVE disclosures from the most recent security release",
        "follow_path": ["kind:llms", "latest-security-disclosures"],
        "destination_kind": "month",
        "select_embedded": ["disclosures"],
        "yields": "json",
        "query_hints": [
          "What CVEs were fixed recently?",
          "Latest .NET security patches?",
          "Most recent CVE disclosures?"
        ],
        "keywords": ["cve", "security", "patch", "vulnerability", "latest", "recent"],
        "intent": "security-audit"
      },
      "cve-critical-latest": {
        "description": "Critical severity CVEs from the most recent security release",
        "follow_path": ["kind:llms", "latest-security-disclosures"],
        "destination_kind": "month",
        "select_embedded": ["disclosures"],
        "filter": "$.disclosures[?(@.cvss_severity == 'CRITICAL')]",
        "yields": "json",
        "query_hints": [
          "Any critical CVEs recently?",
          "Critical .NET vulnerabilities?",
          "Urgent security patches?"
        ],
        "keywords": ["critical", "urgent", "high-severity", "cve"],
        "intent": "security-audit",
        "not_for": [
          "All CVEs regardless of severity",
          "CVE history over multiple months"
        ]
      },
      "cve-history": {
        "description": "CVE disclosures over a time range",
        "variants": {
          "small-range": {
            "condition": "months <= 3",
            "description": "Walk prev-security-month links for small ranges (1-3 months)",
            "follow_path": ["kind:llms", "latest-security-disclosures"],
            "destination_kind": "month",
            "select_embedded": ["disclosures"],
            "iterate": {
              "link": "prev-security-month",
              "until": "prev_security_month_date < cutoff"
            },
            "yields": "json"
          },
          "current-year": {
            "condition": "query bounded to current year",
            "description": "Use latest-year shortcut for current year queries",
            "follow_path": ["kind:llms", "latest-year"],
            "destination_kind": "year",
            "filter": "$._embedded.months[?(@.security == true)]",
            "yields": "json"
          },
          "past-year": {
            "condition": "explicit past year (e.g., '2024 CVEs')",
            "description": "Use timeline index for specific past year queries",
            "follow_path": ["kind:llms", "timeline", "{year}"],
            "destination_kind": "year",
            "filter": "$._embedded.months[?(@.security == true)]",
            "yields": "json"
          }
        },
        "query_hints": [
          "CVEs in the last 6 months?",
          "What vulnerabilities were fixed in 2024?",
          "Security patches since March?"
        ],
        "keywords": ["history", "timeline", "range", "past", "since"],
        "intent": "security-audit"
      },
      "cve-by-version": {
        "description": "CVEs affecting a specific .NET version",
        "follow_path": ["kind:llms", "patches.{version}", "latest-security-disclosures"],
        "destination_kind": "month",
        "select_embedded": ["disclosures"],
        "filter": "$.disclosures[?(@.affected_releases contains '{version}')]",
        "yields": "json",
        "parameters": {
          "version": {
            "description": "The .NET major version (e.g., '8.0', '9.0')",
            "type": "string",
            "required": true
          }
        },
        "query_hints": [
          "What CVEs affect .NET 8?",
          "Security issues for .NET 9.0?",
          "Vulnerabilities in my .NET version?"
        ],
        "keywords": ["version", "affects", "impacted", "vulnerable"],
        "intent": "security-audit",
        "not_for": [
          "CVE history (use cve-history instead)"
        ]
      },
      "cve-details": {
        "description": "Full CVE details: code diffs, version ranges, CWE",
        "follow_path": ["kind:llms", "latest-cve-json"],
        "destination_kind": "cve",
        "yields": "json",
        "query_hints": [
          "Show me the code diffs for CVE fixes",
          "Which versions are vulnerable?",
          "CWE classification?",
          "What's the fixed version?"
        ],
        "keywords": ["diff", "commit", "code", "version", "range", "vulnerable", "fixed", "cwe"],
        "intent": "security-audit",
        "not_for": [
          "Basic CVE info (severity, score)â€”month index has this"
        ],
        "ai_note": "Use latest-cve-json to skip month index. Diff URLs at $.commits[hash].url, version ranges at $.products[]"
      },
      "disclosures-by-version": {
        "description": "Filter disclosures by .NET version from month index already fetched",
        "follow_path": ["kind:month"],
        "filter": "$.disclosures[?(@.affected_releases contains '{version}')]",
        "templated": true,
        "yields": "json",
        "query_hints": [
          "Which of these CVEs affect .NET 8?",
          "Filter these disclosures to .NET 9.0",
          "Show only vulnerabilities for my version"
        ],
        "keywords": ["filter", "version", "these", "from"],
        "intent": "security-audit",
        "example": {
          "version": "8.0",
          "result": "Disclosures where affected_releases includes 8.0"
        }
      }
    }
  }
}
