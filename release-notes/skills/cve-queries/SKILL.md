---
name: cve-queries
description: CVE queries needing severity, CVSS, affected versions, or security history
workflows: https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json
---

# CVE Queries

**Rules:**

- Basic queries (severity, CVSS, affected versions) stop at month index.
- Code diffs and version ranges need cve.json (different schema).

For extraction FROM cve.json, see [cve-schema](https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/SKILL.md).

## Quick Extraction

From month index `_embedded.disclosures[]`:
- `cvss_severity`, `cvss_score`, `affected_releases`, `affected_products`

From cve.json:
- `$.commits[hash].url` (fix URLs)
- `$.products[]`, `$.packages[]` (version ranges)
- `$.disclosures[].weakness` (CWE)

## What's Where

| Source | What You Get | When to Use |
|--------|--------------|-------------|
| patch index `cve_records[]` | CVE IDs only | "What CVEs did X.Y.Z fix?" |
| month index `_embedded.disclosures[]` | Severity, CVSS, affected releases | Filtering by severity, listing CVEs |
| cve.json | CVSS vector, CWE, commit diffs | Code analysis, deep investigation |

## Workflow Router

Workflows provide an end-to-end path for a query.

| Workflow | Use For | Don't Use For | Stop At |
|----------|---------|---------------|---------|
| `cve-latest` | Latest CVEs, recent patches | Historical queries | month index |
| `cve-critical-latest` | Critical/urgent CVEs only | All severities | month index |
| `cve-by-version` | CVEs for .NET 8, 9, etc. | Time ranges | month index |
| `cve-history` | Last N months, date ranges | Single version | month index |
| `cve-details` | Code diffs, CWE, packages | Basic severity/CVSS | cve.json |

Fetch: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json>

## Query Strategies

| Query Type | Path | Stop At |
|------------|------|---------|
| CVE IDs for a patch | major → patch | `cve_records[]` |
| CVE severity for a patch | major → patch → `security-disclosures` | month index |
| Time range (1-3 months) | `latest-security-disclosures` → walk `prev-security-month` | month index |
| Time range (4+ months) | year index → batch `cve-json` links | cve.json |
| Code diffs needed | any path → `cve-json` | cve.json |

**Key:** For 4+ month ranges, go directly to `cve-json` links from year index `_embedded.months[]`. Don't fetch month indexes first.

## Cross-year Navigation

**llms.json only has `latest-year` (e.g., 2025). Previous years are NOT linked from llms.json.**

1. llms.json `_links.latest-year` → 2025/index.json
2. 2025/index.json `_links.prev-year` → 2024/index.json
3. Then batch `_embedded.months[].cve-json` links

**This is sequential—you cannot fetch 2024 and 2025 year indexes in parallel.** You must fetch 2025 first to discover the 2024 link.

## Common Mistakes

| Mistake | Why Wrong |
|---------|-----------|
| Fetching 2024/index.json directly | llms.json only links to latest year. Fetch 2025 first, then follow `prev-year` |
| Batching year indexes in parallel | You can't—2024's URL only exists in 2025's response |
| Constructing month/year URLs | Not all months exist—only security months. Follow `_links` |
| Fabricating `.patch` from `.diff` URL | The graph provides `.diff` URLs. Don't modify them |
| Fabricating commit URLs | Use `$.commits[hash].url` from cve.json—don't construct URLs |
| Fetching month index for just CVE IDs | Patch index `cve_records[]` has IDs. Only fetch month for severity |
| Fetching cve.json for severity/CVSS | Month index has severity. Only fetch cve.json for diffs/CWE |

## Related Skills

| Skill | When |
|-------|------|
| [cve-schema](https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/SKILL.md) | Extracting from cve.json (lookup tables, commit details) |
