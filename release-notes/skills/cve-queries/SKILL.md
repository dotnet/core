---
name: cve-queries
description: CVE queries needing severity, CVSS, affected versions, or security history
workflows: https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json
---

# CVE Queries

For extraction FROM cve.json, see cve-schema:

- Skill: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/SKILL.md>
- Workflows: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/workflows.json>

## First: What Type of Query?

| Query | Workflow | Stop at |
| ----- | -------- | ------- |
| Latest CVEs | `cve-latest` | month index |
| CVEs for .NET X | `cve-by-version` | month index |
| CVEs over time range | `cve-history` | month index |
| Code diffs, version ranges, CWE | `cve-details` | cve.json |

**Code diffs and version ranges need cve.json:** Go directly—skip month index.

## Quick Answers

From month index `_embedded.disclosures[]`:

- CVE severity? → `cvss_severity`
- CVSS score? → `cvss_score`
- Which versions affected? → `affected_releases`
- Which products? → `affected_products`

From cve.json (code diffs, version ranges, CWE):

- Fix commit URLs? → `$.commits[hash].url`
- Version ranges? → `$.products[]` or `$.packages[]` (`min_vulnerable`, `fixed`)
- CWE? → `$.disclosures[].weakness`

**Filtering by version:** `disclosures.filter(d => d.affected_releases.includes("8.0"))`

**Time ranges:** "Last N months" = calendar months, not security releases. Calculate cutoff date first.

## Stop Criteria

**Basic queries:** STOP at month index. Has severity, CVSS score, affected versions.

**Code diffs/CWE/packages:** STOP at cve.json. Skip month index—go directly to cve.json.

## Workflows

```json
"cve-latest": {
  "follow_path": ["kind:llms", "latest-security-disclosures"],
  "destination_kind": "month",
  "select_embedded": ["disclosures"]
}
```

```json
"cve-by-version": {
  "follow_path": ["kind:llms", "patches.{version}", "latest-security-disclosures"],
  "destination_kind": "month",
  "select_embedded": ["disclosures"]
}
```

```json
"cve-details": {
  "follow_path": ["kind:llms", "latest-cve-json"],
  "destination_kind": "cve",
  "note": "skip month index - go directly to cve.json"
}
```

## CVE History Strategies

| Query Type | Strategy | Path |
| ---------- | -------- | ---- |
| Short range (1-3 months) | Walk `prev-security-month` | Start from `latest-security-month` |
| Specific unit (1 year/month) | Fetch that index directly | `timeline` → `{year}` or `{year}/{month}` |
| Large range (cross-year) | Fetch year indexes, filter months | Filter `_embedded.months` by range |

**Year index optimization:** Security months have `cve-json` links directly in `_embedded.months[]`. Skip month index—go year → cve.json.

**Do not construct URLs:** Only months with `security: true` have `cve-json` links. Follow the links—don't fabricate URLs like `timeline/2024/12/cve.json` for non-security months.

```json
"disclosures-by-version": {
  "follow_path": ["kind:month"],
  "filter": "$.disclosures[?(@.affected_releases contains '{version}')]",
  "yields": "json"
}
```

**Example:** Get .NET 8.0 CVEs from current month:

```text
filter: $.disclosures[?(@.affected_releases contains '8.0')]
→ returns only disclosures affecting 8.0
```

All workflows: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json>

## External Schema: Month Index

| Field | Description |
| ----- | ----------- |
| `id` | CVE identifier (CVE-2025-XXXXX) |
| `title` | Vulnerability title |
| `cvss_score` | 0-10 |
| `cvss_severity` | NONE, LOW, MEDIUM, HIGH, CRITICAL |
| `affected_releases` | Array: ["8.0", "9.0"] |
| `affected_products` | Array: ["dotnet-runtime", "dotnet-aspnetcore"] |

## Common Mistakes

| Mistake | Why It's Wrong |
| ------- | -------------- |
| Constructing cve.json URLs | Only security months have cve.json—follow `_embedded.months[].cve-json` links |
| Fetching month index then cve.json | Year index has `cve-json` links—skip month index |
| Fetching months outside date range | Filter by date AND security flag before collecting links |
| Fetching cve.json for severity/CVSS score | Month index already has this |
| Fabricating commit URLs | Use `$.commits[hash].url` from cve.json |

## Tips

- `latest-cve-json` goes directly to cve.json (skips month index)
- Year index `_embedded.months[]` has `cve-json` links for security months
- `prev-security-month` auto-skips non-security months
- Fix URLs are in cve.json at `$.commits[hash].url`
