---
name: cve-queries
description: CVE queries needing severity, CVSS, affected versions, or security history
workflows: https://raw.githubusercontent.com/dotnet/core/release-index/release-notes/skills/cve-queries/workflows.json
---

# CVE Queries

## Workflows

| Workflow | Use when |
|----------|----------|
| `cve-latest` | All CVEs from most recent security release |
| `cve-critical-latest` | Only critical severity CVEs |
| `cve-history` | CVEs over a time range (has variants) |
| `cve-by-version` | CVEs affecting a specific .NET version |
| `cve-details` | Navigate to cve.json (has entry point variants) |

For extraction FROM cve.json, see `cve-schema` skill.

### Entry points for `cve-details`

| Variant | When | Path |
|---------|------|------|
| `from-llms` | cold start | `llms` → `latest-security-month` → `cve-json` |
| `from-year` | at year index | `cve-json` |
| `from-month` | at month index | `cve-json` |
| `from-major` | at major index | `cve-json` |
| `from-patch` | at patch index | `cve-json` |

### Variant selection for `cve-history`

| Query scope | Variant | Path |
|-------------|---------|------|
| 1-3 months | `small-range` | Walk `prev-security-month` links |
| Current year | `current-year` | `latest-year` shortcut |
| Past year (e.g., "2024") | `past-year` | `timeline` → `{year}` |

Calculate cutoff date first. "Last 12 months" from Oct 2025 = Oct 2024 cutoff.

## Stop Criteria

**STOP when you have the month index.** `_embedded.disclosures[]` contains severity, CVSS, titles, and fix commits. Only fetch `cve.json` for full CVSS vectors, CWE, or package version ranges.

## Quick Answers (from month index)

Once you have the month index, answer directly from `_embedded.disclosures[]`:

- CVE severity? → `cvss_severity`
- CVSS score? → `cvss_score`
- Which versions affected? → `affected_releases`
- Fix commits? → `fixes[].href`

## Interpretation

### Filtering by version

Filter `_embedded.disclosures[]` by `affected_releases`:

```javascript
disclosures.filter(d => d.affected_releases.includes("8.0"))
```

### Time ranges

"Last N months" = **calendar months**, not security releases. Security months are sparse—calculate cutoff date before navigating.

## Disclosure Fields

| Field | Description |
|-------|-------------|
| `id` | CVE identifier (CVE-2025-XXXXX) |
| `title` | Vulnerability title |
| `cvss_score` | 0-10 |
| `cvss_severity` | NONE, LOW, MEDIUM, HIGH, CRITICAL |
| `affected_releases` | Array: ["8.0", "9.0"] |
| `fixes[]` | Commit diff URLs (`.diff`) per release |

## Common Mistakes

| Mistake | Why It's Wrong |
|---------|----------------|
| Fetching all `security: true` months | Calculate cutoff date first—exclude months before cutoff |
| Confusing "12 months" with "12 security releases" | Calendar months, not security months |
| Fetching `cve.json` for severity/CVSS | Month index already has this |
| Fabricating month or commit URLs | Use `_links` or `fixes[].href` |

## Tips

- `prev-security-month` auto-skips non-security months
- Fix URLs end in `.diff`—use directly
- `cve-json` link available from: llms, year, month, major, patch indexes (not root/timeline)
- Use `cve-json` only when you need: CVSS vectors, CWE, package version ranges, or commit details
