---
name: cve-queries
description: CVE queries needing severity, CVSS, affected versions, or security history
workflows: https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json
---

# CVE Queries

For extraction FROM cve.json, see cve-schema:

- Skill: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/SKILL.md>
- Workflows: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/workflows.json>

## First: What Type of Query?

| Query | Workflow |
| ----- | -------- |
| Latest CVEs | `cve-latest` |
| CVEs for .NET X | `cve-by-version` |
| CVEs over time range | `cve-history` (see variants below) |
| Full details (CVSS vectors, CWE) | `cve-details` |

## Quick Answers

From month index `_embedded.disclosures[]`:

- CVE severity? → `cvss_severity`
- CVSS score? → `cvss_score`
- Which versions affected? → `affected_releases`
- Fix commits? → `fixes[].href`

**Filtering by version:** `disclosures.filter(d => d.affected_releases.includes("8.0"))`

**Time ranges:** "Last N months" = calendar months, not security releases. Calculate cutoff date first.

## Stop Criteria

**STOP when you have the month index.** `_embedded.disclosures[]` contains severity, CVSS, titles, and fix commits. Only fetch `cve.json` for CVSS vectors, CWE, or package ranges.

## Workflows

```json
"cve-latest": {
  "follow_path": ["kind:llms", "latest-security-disclosures"],
  "destination_kind": "month",
  "select_embedded": ["disclosures"]
}
```

```json
"cve-by-version": {
  "follow_path": ["kind:llms", "patches.{version}", "latest-security-disclosures"],
  "destination_kind": "month",
  "select_embedded": ["disclosures"]
}
```

```json
"cve-details": {
  "follow_path": ["kind:llms", "latest-security-disclosures", "cve-json"],
  "destination_kind": "cve"
}
```

**cve-history variants:**

| Query scope | Variant | Path |
| ----------- | ------- | ---- |
| 1-3 months | `small-range` | Walk `prev-security-month` links |
| Current year | `current-year` | `latest-year` shortcut |
| Past year (e.g., "2024") | `past-year` | `timeline` → `{year}` |

```json
"disclosures-by-version": {
  "follow_path": ["kind:month"],
  "filter": "$.disclosures[?(@.affected_releases contains '{version}')]",
  "yields": "json"
}
```

**Example:** Get .NET 8.0 CVEs from current month:

```text
filter: $.disclosures[?(@.affected_releases contains '8.0')]
→ returns only disclosures affecting 8.0
```

All workflows: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json>

## External Schema: Month Index

| Field | Description |
| ----- | ----------- |
| `id` | CVE identifier (CVE-2025-XXXXX) |
| `title` | Vulnerability title |
| `cvss_score` | 0-10 |
| `cvss_severity` | NONE, LOW, MEDIUM, HIGH, CRITICAL |
| `affected_releases` | Array: ["8.0", "9.0"] |
| `fixes[]` | Commit diff URLs (`.diff`) per release |

## Common Mistakes

| Mistake | Why It's Wrong |
| ------- | -------------- |
| Fetching all `security: true` months | Calculate cutoff date first—exclude months before cutoff |
| Confusing "12 months" with "12 security releases" | Calendar months, not security months |
| Fetching `cve.json` for severity/CVSS | Month index already has this |
| Fabricating month or commit URLs | Use `_links` or `fixes[].href` |

## Tips

- `latest-security-disclosures` available at both llms and patch level
- `prev-security-month` auto-skips non-security months
- Fix URLs end in `.diff`—use directly
- Use `cve-json` only for: CVSS vectors, CWE, package ranges
