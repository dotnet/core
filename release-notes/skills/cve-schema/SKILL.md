---
name: cve-schema
description: Extraction patterns for cve.json documents
workflows: https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/workflows.json
---

# CVE Schema

Extraction from cve.json documents. To navigate TO cve.json first, see cve-queries:

- Skill: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/SKILL.md>
- Workflows: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-queries/workflows.json>

## First: What to Extract?

| Need | Workflow | Uses |
| ---- | -------- | ---- |
| All CVE IDs | `cve-list` | `$.disclosures[].id` |
| CVSS vector/metrics | `cve-cvss-vector` | `$.disclosures[?(@.id == '{cve_id}')].cvss` |
| CWE classification | `cve-cwe` | `$.disclosures[?(@.id == '{cve_id}')].weakness` |
| Affected packages | `cve-packages` | `$.packages[?(@.cve_id == '{cve_id}')]` |
| Affected products | `cve-products` | `$.products[?(@.cve_id == '{cve_id}')]` |
| Fix commits | `cve-commits` | `$.cve_commits['{cve_id}']` |
| CVEs by package | `cve-by-package` | `$.package_cves` lookup |
| CVEs by product | `cve-by-product` | `$.product_cves` lookup |
| CVEs by severity | `cve-by-severity` | `$.severity_cves` lookup |
| CVEs by release | `cve-by-release` | `$.release_cves` lookup |

## Quick Answers

From cve.json lookup tables (O(1) access):

- Critical CVEs? → `$.severity_cves.CRITICAL`
- CVEs for .NET 8? → `$.release_cves["8.0"]`
- CVEs for ASP.NET Core? → `$.product_cves["dotnet-aspnetcore"]`
- CVEs for a package? → `$.package_cves["Microsoft.Build"]`
- Commits for a CVE? → `$.cve_commits["CVE-2025-XXXXX"]`

## Stop Criteria

**You already have cve.json.** Use lookup tables for filtering—don't fetch additional resources.

## Workflows

```json
"cve-by-severity": {
  "follow_path": ["kind:cve"],
  "filter": "$.severity_cves['{severity}']",
  "yields": "json"
}
```

```json
"cve-packages": {
  "follow_path": ["kind:cve"],
  "filter": "$.packages[?(@.cve_id == '{cve_id}')]",
  "yields": "json"
}
```

**Example:** Get all critical CVEs and their affected packages:

```text
$.severity_cves.CRITICAL → ["CVE-2025-55315"]
$.packages[?(@.cve_id == 'CVE-2025-55315')] → package details
```

All workflows: <https://raw.githubusercontent.com/dotnet/core/refs/heads/release-index/release-notes/skills/cve-schema/workflows.json>

## External Schema: cve.json

**`$.disclosures[]`** — Full CVE records:

| Field | Description |
| ----- | ----------- |
| `id` | CVE identifier |
| `cvss.vector` | Full CVSS vector string |
| `cvss.score` | 0-10 |
| `cvss.severity` | CRITICAL, HIGH, MEDIUM, LOW |
| `weakness` | CWE identifier |

**`$.products[]`** / **`$.packages[]`** — Version ranges:

| Field | Description |
| ----- | ----------- |
| `cve_id` | CVE identifier |
| `name` | Product or package name |
| `min_vulnerable` | First vulnerable version |
| `fixed` | Fixed version |

**Lookup tables** — Direct O(1) access:

| Table | Key → Value |
| ----- | ----------- |
| `$.severity_cves` | severity → CVE IDs |
| `$.release_cves` | release → CVE IDs |
| `$.package_cves` | package → CVE IDs |
| `$.product_cves` | product → CVE IDs |
| `$.cve_commits` | CVE ID → commit hashes |

## Common Mistakes

| Mistake | Correction |
| ------- | ---------- |
| Filtering when lookup table exists | Use `$.severity_cves.CRITICAL` not filter |
| Fetching cve.json for basic info | Month index has severity, score, title |
| Constructing commit URLs | Use `$.commits[hash].url` |

## Tips

- Lookup tables are O(1)—prefer them over filters
- Product names: `dotnet-runtime`, `dotnet-sdk`, `dotnet-aspnetcore`
- Get commit hash from `$.cve_commits[cve_id]`, then details from `$.commits[hash]`
