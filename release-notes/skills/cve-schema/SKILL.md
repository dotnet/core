---
name: cve-schema
description: Extraction patterns for cve.json documents
workflows: https://raw.githubusercontent.com/dotnet/core/release-index/release-notes/skills/cve-schema/workflows.json
---

# CVE Schema

This skill covers extraction from cve.json documents. Use `cve-queries` skill to navigate TO cve.json first.

## Workflows

| Workflow | Extracts |
|----------|----------|
| `cve-cvss-vector` | Full CVSS object (vector, score, severity) |
| `cve-cwe` | CWE weakness classification |
| `cve-packages` | NuGet packages with version ranges |
| `cve-products` | Products with version ranges |
| `cve-commits` | Fix commits with diff URLs |
| `cve-by-package` | CVEs for a NuGet package |
| `cve-by-product` | CVEs for a product |
| `cve-by-severity` | CVEs at a severity level |
| `cve-by-release` | CVEs for a .NET release |

All workflows start with `kind:cve`—they assume you're already at a cve.json document.

## Schema Overview

### `$.disclosures[]`

Full CVE records with details not in month index.

| Field | Type | Description |
|-------|------|-------------|
| `id` | string | CVE identifier |
| `problem` | string | Vulnerability title |
| `description` | array | Detailed description |
| `cvss.version` | string | CVSS version (3.1) |
| `cvss.vector` | string | Full CVSS vector string |
| `cvss.score` | number | 0-10 |
| `cvss.severity` | string | CRITICAL, HIGH, MEDIUM, LOW |
| `weakness` | string | CWE identifier |
| `timeline` | object | Disclosure and fix dates |
| `platforms` | array | Affected platforms |
| `cna` | object | CNA-specific info (FAQ, impact) |

### `$.products[]`

Product-level impact with version ranges.

| Field | Type | Description |
|-------|------|-------------|
| `cve_id` | string | CVE identifier |
| `name` | string | Product (dotnet-runtime, dotnet-sdk, dotnet-aspnetcore) |
| `min_vulnerable` | string | First vulnerable version |
| `max_vulnerable` | string | Last vulnerable version |
| `fixed` | string | Fixed version |
| `release` | string | .NET release (8.0, 9.0) |
| `commits` | array | Fix commit hashes |

### `$.packages[]`

NuGet package-level impact (same structure as products).

| Field | Type | Description |
|-------|------|-------------|
| `cve_id` | string | CVE identifier |
| `name` | string | Package name (e.g., Microsoft.Build) |
| `min_vulnerable` | string | First vulnerable version |
| `max_vulnerable` | string | Last vulnerable version |
| `fixed` | string | Fixed version |

### `$.commits{}`

Commit details indexed by hash.

| Field | Type | Description |
|-------|------|-------------|
| `repo` | string | Repository name |
| `branch` | string | Branch name |
| `hash` | string | Commit hash |
| `org` | string | GitHub org |
| `url` | string | Diff URL (.diff) |

### Lookup Tables

Pre-computed for common queries—direct property access, no filtering needed.

| Table | Key | Returns |
|-------|-----|---------|
| `$.product_cves` | product name | CVE IDs |
| `$.package_cves` | package name | CVE IDs |
| `$.release_cves` | release (8.0) | CVE IDs |
| `$.severity_cves` | severity level | CVE IDs |
| `$.cve_releases` | CVE ID | releases |
| `$.cve_commits` | CVE ID | commit hashes |

## Common Mistakes

| Mistake | Correction |
|---------|------------|
| Filtering when lookup table exists | Use `$.severity_cves.CRITICAL` not filter |
| Fetching cve.json for basic info | Month index has severity, score, title |
| Constructing commit URLs | Use `$.commits[hash].url` |

## Tips

- Lookup tables are O(1)—prefer them over filters
- `$.commits{}` indexed by hash—get hash from `$.cve_commits[cve_id]` first
- Product names: `dotnet-runtime`, `dotnet-sdk`, `dotnet-aspnetcore`
